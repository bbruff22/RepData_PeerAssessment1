---
title: "PA1_template"
author: "BB"
date: "5/12/2019"
output: html_document
---
###Requirement 1: Code for reading in the dataset and/or processing the data
####include dplyr and ggplot2 packages
```{r}
require(dplyr)
require(ggplot2)
```

###Read in the dataset 
```{r}
setwd("~/Desktop/Coursera Files/Course5_ReproRsrch")
activityData<-read.csv("./data/activity.csv", stringsAsFactors = FALSE)
activityData$date <- as.Date(activityData$date)
str(activityData)
```
###Requirement 2: Histogram of the total number of steps taken each day
###What is mean total number of steps taken per day?
```{r}
sByd <- activityData %>% group_by(date) %>% summarise(steps2 = sum(steps, na.rm = TRUE))
hist(sByd$steps2,col = 'grey',xlab = "Steps",ylab = "Frequency",main = "Total Steps per Day")
```
###Mean and median number of steps taken each day
```{r}
print(meanSteps <- mean(sByd$steps2))
print(medianSteps <- median(sByd$steps2))
```

###Time series plot of the average number of steps taken
###What is the average daily activity pattern?
```{r}
asByI <- activityData %>% group_by(interval) %>% summarise(avgSteps = mean(steps, na.rm = TRUE))
plot(asByI$interval,asByI$avgSteps,type = "o",xlab = "Intervals",
     ylab = "Average Steps",main = "Average Steps per Interval")
```

###Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
```{r}
intAndSteps <- asByI[which.max(asByI$avgSteps),] #this is correct at 835
print(intAndSteps)
print(medianSteps <- median(sByd$steps2))
```

###Imputing missing data
#Strategy: Calculate the average of average steps per day across all dates in the data set (ignoring NA values). Then use the resulting value in place of NAs.

```{r}
sum(is.na(activityData$steps))

idx <- which(is.na(activityData$steps))
l <- length(idx)
stepsAvg <- with(activityData,tapply(steps,date,mean,na.rm=TRUE))
activityData %>% group_by(date) %>% summarise(avgSteps = mean(steps, na.rm = TRUE))

stepsMean <- mean(stepsAvg,na.rm = TRUE)
for (i in 1:l) {
  activityData[idx,"steps"] <- stepsMean
}

sum(is.na(activityData$steps))
```

### We have zero NAs which means we have successfully filled all missing data and new dataset looks like as follows
```{r}
str(activityData)
```

###Create a histogram of the total number of steps taken each day after missing values are imputed
```{r}
steps3<-with(activityData,tapply(steps,date,sum,na.rm=TRUE))
hist(steps3,col = "grey",xlab = "Steps",ylab = "Frequency",main = "Total Steps per Day")
```

###Mean and median of the total steps taken each day
```{r}
print(meanSteps <- mean(steps3))
print(medianSteps <- median(steps3))
```
